# 1.1 INSTALAR PAQUETES DE FUNCIONES
#********************************************************************
# Lista de paquetes de funciones a instalar
.packages = c("wordcloud2","FSA","car","plotly","ggplot2", "plotly", "xlsx","scales","stringr","readr","dplyr","psych","readxl","ggpubr","PerformanceAnalytics")
.packages %in% installed.packages()
##
# Instala los paquetes sinÃ³ los tienes instalados
##
.inst <- .packages %in% installed.packages()
if(length(.packages[!.inst]) > 0) install.packages(.packages[!.inst])
#********************************************************************
# 1.2 CARGAR PAQUETES O CREAR FUNCIONES
#********************************************************************
# Carga los paquetes sinÃ³ los tienes cargados
lapply(.packages, require, character.only=TRUE)
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna"),
Cantidad   = c(30,15, 35,20,10))
View(df)
wordcloud2(df,size=1.6)
wordcloud2(df)
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
Cantidad   = c(30,15, 35,20,10,18))
wordcloud2(df)
wordcloud2(df,size=2.3)
wordcloud2(df,size=1)
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
Cantidad   = c(35,15, 35,20,10,18))
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-light', backgroundColor="black")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="black")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="black")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="black")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="gray")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="blue")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="lightblue")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-light', backgroundColor="lightblue")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-light', backgroundColor="lightblue")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-light', backgroundColor="lightblue")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-light', backgroundColor="lightblue")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-light', backgroundColor="brown")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="brown")
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
Cantidad   = c(35,15, 35,20,10,18))
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="brown")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark')
View(df)
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark')
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
"Cantidad"  = c(35,15, 35,20,10,18))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark')
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
"Cantidad"  = c(35,15, 50,20,10,18))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark')
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
"Cantidad"  = c(35,15, 50,25,10,18))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
"Cantidad"  = c(35,15,50,25,10,18))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame("Palabra"  = c("Temor"),
"Cantidad"  = c(35))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
# 1.1 INSTALAR PAQUETES DE FUNCIONES
#********************************************************************
# Lista de paquetes de funciones a instalar
.packages = c("wordcloud2","FSA","car","plotly","ggplot2", "plotly", "xlsx","scales","stringr","readr","dplyr","psych","readxl","ggpubr","PerformanceAnalytics")
#********************************************************************
# 1.2 CARGAR PAQUETES O CREAR FUNCIONES
#********************************************************************
# Carga los paquetes sinÃ³ los tienes cargados
lapply(.packages, require, character.only=TRUE)
df <-  data.frame("Palabra"  = c("Temor"),
"Cantidad"  = c(35))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento"),
"Cantidad"  = c(35,15))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento"),
"Cantidad"  = c(35,15))
df <-  data.frame(Palabra  = c("Temor","Desconocimiento"),
Cantidad  = c(35,15)
)
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","Repercusiones"),
Cantidad  = c(35,15,15)
)
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,50,25,10,18)
)
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,50,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","jjjjjj","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,50,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","jjjjjj","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,14,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,14,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,45,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,27,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Desc","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,27,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,27,25,10,18)
)
wordcloud2(df)
wordcloud2(df,size = 0.5)
df <-  data.frame(Palabra  = c("Temor","Deconocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,27,25,10,18)
)
wordcloud2(df,size = 0.5)
df <-  data.frame(Palabra  = c("Temor","Conocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,27,25,10,18)
)
wordcloud2(df,size = 0.5)
wordcloud2(df,size = 0.5)
df <-  data.frame(Palabra  = c("Temor","Conocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,23,27,25,10,18)
)
df <-  data.frame(Palabra  = c("Temor","Conocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,23,27,25,10,18)
)
wordcloud2(df,size = 0.5)
wordcloud2(df,size = 1)
wordcloud2(df,size = .80)
wordcloud2(df,size = .80,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
wordcloud2(df,size = .80,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1.5)
wordcloud2(df,size = .80,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
wordcloud2(df,size = .80,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
wordcloud2(df,size = .80,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
df <-  data.frame(Palabra  = c("Temor","Conocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,23,32,25,10,18)
)
wordcloud2(df,size = .80,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
wordcloud2(df,size = .70,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
df <-  data.frame(Palabra  = c("Temor","Conocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(40,23,32,25,10,18)
)
wordcloud2(df,size = .70,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
df <-  data.frame(Palabra  = c("Temor","Conocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(40,23,32,40,10,18)
)
wordcloud2(df,size = .70,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
.packages = c("FSA","car","plotly","ggplot2", "plotly", "xlsx","scales","stringr","readr","dplyr","psych","readxl","ggpubr","PerformanceAnalytics")
.packages %in% installed.packages()
##
# Instala los paquetes sinÃ³ los tienes instalados
##
.inst <- .packages %in% installed.packages()
if(length(.packages[!.inst]) > 0) install.packages(.packages[!.inst])
#********************************************************************
# 1.2 CARGAR PAQUETES O CREAR FUNCIONES
#********************************************************************
# Carga los paquetes sinÃ³ los tienes cargados
lapply(.packages, require, character.only=TRUE)
crea_errdiagram <- function(Datos,columna,agrupapor,titulo="Titulo",xlabel="xlabel",ylabel="ylabel"){
dfsumarize <- Datos %>%
group_by(get(agrupapor)) %>%
summarise(
sd = sd(get(columna),na.rm = TRUE),
media = mean(get(columna)))
#####
#  Creo grafico de errores o de medias
####
ggplot(dfsumarize, aes(x=reorder(`get(agrupapor)`,media), y=media,color=`get(agrupapor)`)) +
geom_line(aes(group = 1)) +
geom_errorbar( aes(ymin=media-sd,ymax=media + sd),width = 0.2) +
geom_point(size = 2) +
labs(title = titulo,
subtitle = "",
caption = "Data source: Analiza tus Datos",
x = xlabel,
y = ylabel,
tag = "Primeros Programas con R") +
theme(plot.title    = element_text(size =12, face = "bold", hjust = 0.5  ),
plot.subtitle = element_text(size = 9, hjust = 0.5),
plot.caption  = element_text(size = 7),
plot.tag      = element_text(size = 7),
axis.text     = element_text(size=8),
axis.title    = element_text(size=8,face="bold"))
}
creaboxplot <- function(Datos, var_x,var_y,Titulo,xlabel="NA",ylabel="NA"){
ggplot(data = Datos) +
geom_boxplot(mapping = aes(
x = reorder(get(var_x),get(var_y),FUN = median),
y = get(var_y),fill=get(var_x)
)) +
geom_jitter(mapping = aes(x=get(var_x),y=get(var_y)),position=position_jitter(0.2))+
labs(title = Titulo,
subtitle = "",
caption = "Data source: Analiza tus Datos",
x = xlabel,
y = ylabel,
tag = "Primeros Programas con R") +
theme(plot.title    = element_text(size =12, face = "bold", hjust = 0.5  ),
plot.subtitle = element_text(size = 9, hjust = 0.5),
plot.caption  = element_text(size = 7),
plot.tag      = element_text(size = 7),
axis.text     = element_text(size=8),
axis.title    = element_text(size=8,face="bold"))
}
setwd("~/Analiza tus Datos/Etapa 2/Bloque 5 Analiza tus Datos/3. Tablas ANOVA de 1 FACTOR MAS DE 2 GRUPOS")
###
# Seteo el Directorio....
##
setwd("~/Analiza tus Datos/Etapa 2/Bloque 5 Analiza tus Datos/3. Tablas ANOVA de 1 FACTOR MAS DE 2 GRUPOS")
df <- espalda <- read_excel("espalda.xlsx")
str(df)
unique(df%NHD)
unique(df$NHD)
###
# Preparo datos, creo columnas, grupos etc
###
df$diffodi  <- df$`ODI Mes0` - df$`ODI Mes1` # agrego  variable con la mejoria
#creo factores
df$NHD <- factor(df$NHD,labels  = c("Sin Hernia","1 Hernia","2 Hernias")) #Hernias
df$Grupo <- factor(df$Grupo,labels = c("Convencional","Experimental")) #Tipo de tratamiento
str(df)
unique(df$NHD)
ggplot(data = df,
mapping = aes(x=diffodi,y=..density..)) +
geom_freqpoly(mapping=aes(color=NHD),binwidth=5)
ggplot(data = df,
mapping = aes(x=diffodi,y=..density..)) +
geom_freqpoly(mapping=aes(color=NHD))
ggplot(data = df,
mapping = aes(x=diffodi)) +
geom_histogram(mapping=aes(color=NHD))
..density..
ggplot(data = df,
mapping = aes(x=diffodi,y=..density..)) +
geom_freqpoly(mapping=aes(color=NHD))
ggplot(data = df,
mapping = aes(x=diffodi,y=..density..)) +
geom_density(mapping=aes(color=NHD))
ggplot(df) +
geom_density(mapping = aes(x=diffodi,fill=NHD),alpha=0.2)
creaboxplot(df,"NHD","diffodi","Box Plot Diffoddi por Hernias","Hernias","diffoddi")
crea_errdiagram(df,"diffodi","NHD","Diagrama de Medias diffoddi por NHD","NHD","diffodi")
t_aov <-  aov(diffodi ~ NHD,data=df)
summary.aov(t_aov)
##
# Calculo Normalidad de los residuales de la Anota
##
shapiro.test(t_aov.residuals)
##
# Calculo Normalidad de los residuales de la Anota
##
shapiro.test(t_aov$residuals)
##
# Calculo Normalidad de los residuales de la Anota
##
residuos <- residuals(object = t_aov)
shapiro.test(residuos)
##
# Calculo Normalidad de los residuales de la Anova
##
shapiro.test(t_aov$residuals)
leveneTest(diffodi ~ NHD, data=df)
plot(t_aov$residuals,2)
resisuales <- residuals(object = t_aov)
plot(residuales)
resisudales <- residuals(object = t_aov)
plot(residuales)
residales <- residuals(object = t_aov)
plot(residuales)
residuales <- residuals(object = t_aov)
plot(residuales)
plot(residuales,main = "Plot de Residuales del Anova por NHD")
summary.aov(t_aov$coefficients)
summary.aov(t_aov$residuals)
summary.aov(t_aov)
summary.aov(t_aov,split = T)
leveneTest(diffodi ~ NHD, data=df)
##
# Como los residuales de ANOVA NO dieron  NORMALES se usa Kruskall-wallis
##
kruskal.test(diffodi ~ NHD,data=df)
##
# Como los residuales de ANOVA NO dieron  NORMALES se usa Kruskall-wallis
# TEST NO PARAMETRICO
##
kruskal.test(diffodi ~ NHD,data=df)
