# 1.1 INSTALAR PAQUETES DE FUNCIONES
#********************************************************************
# Lista de paquetes de funciones a instalar
.packages = c("wordcloud2","FSA","car","plotly","ggplot2", "plotly", "xlsx","scales","stringr","readr","dplyr","psych","readxl","ggpubr","PerformanceAnalytics")
.packages %in% installed.packages()
##
# Instala los paquetes sinÃ³ los tienes instalados
##
.inst <- .packages %in% installed.packages()
if(length(.packages[!.inst]) > 0) install.packages(.packages[!.inst])
#********************************************************************
# 1.2 CARGAR PAQUETES O CREAR FUNCIONES
#********************************************************************
# Carga los paquetes sinÃ³ los tienes cargados
lapply(.packages, require, character.only=TRUE)
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna"),
Cantidad   = c(30,15, 35,20,10))
View(df)
wordcloud2(df,size=1.6)
wordcloud2(df)
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
Cantidad   = c(30,15, 35,20,10,18))
wordcloud2(df)
wordcloud2(df,size=2.3)
wordcloud2(df,size=1)
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
Cantidad   = c(35,15, 35,20,10,18))
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-light', backgroundColor="black")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="black")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="black")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="black")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="gray")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="blue")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="lightblue")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-light', backgroundColor="lightblue")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-light', backgroundColor="lightblue")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-light', backgroundColor="lightblue")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-light', backgroundColor="lightblue")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-light', backgroundColor="brown")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="brown")
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
Cantidad   = c(35,15, 35,20,10,18))
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark', backgroundColor="brown")
wordcloud2(df,size=1, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark')
View(df)
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark')
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
"Cantidad"  = c(35,15, 35,20,10,18))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark')
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
"Cantidad"  = c(35,15, 50,20,10,18))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1,color='random-dark')
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
"Cantidad"  = c(35,15, 50,25,10,18))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento", "Repercusiones", "Desinterés","Solución Interna","Capacitacion"),
"Cantidad"  = c(35,15,50,25,10,18))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame("Palabra"  = c("Temor"),
"Cantidad"  = c(35))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
# 1.1 INSTALAR PAQUETES DE FUNCIONES
#********************************************************************
# Lista de paquetes de funciones a instalar
.packages = c("wordcloud2","FSA","car","plotly","ggplot2", "plotly", "xlsx","scales","stringr","readr","dplyr","psych","readxl","ggpubr","PerformanceAnalytics")
#********************************************************************
# 1.2 CARGAR PAQUETES O CREAR FUNCIONES
#********************************************************************
# Carga los paquetes sinÃ³ los tienes cargados
lapply(.packages, require, character.only=TRUE)
df <-  data.frame("Palabra"  = c("Temor"),
"Cantidad"  = c(35))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento"),
"Cantidad"  = c(35,15))
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1
df <-  data.frame("Palabra"  = c("Temor","Desconocimiento"),
"Cantidad"  = c(35,15))
df <-  data.frame(Palabra  = c("Temor","Desconocimiento"),
Cantidad  = c(35,15)
)
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","Repercusiones"),
Cantidad  = c(35,15,15)
)
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,50,25,10,18)
)
wordcloud2(df, minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,50,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","jjjjjj","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,50,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","jjjjjj","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,14,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,14,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,45,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Desconocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,27,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Desc","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,15,27,25,10,18)
)
wordcloud2(df)
df <-  data.frame(Palabra  = c("Temor","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,27,25,10,18)
)
wordcloud2(df)
wordcloud2(df,size = 0.5)
df <-  data.frame(Palabra  = c("Temor","Deconocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,27,25,10,18)
)
wordcloud2(df,size = 0.5)
df <-  data.frame(Palabra  = c("Temor","Conocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,27,25,10,18)
)
wordcloud2(df,size = 0.5)
wordcloud2(df,size = 0.5)
df <-  data.frame(Palabra  = c("Temor","Conocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,23,27,25,10,18)
)
df <-  data.frame(Palabra  = c("Temor","Conocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,23,27,25,10,18)
)
wordcloud2(df,size = 0.5)
wordcloud2(df,size = 1)
wordcloud2(df,size = .80)
wordcloud2(df,size = .80,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1)
wordcloud2(df,size = .80,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = 1.5)
wordcloud2(df,size = .80,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
wordcloud2(df,size = .80,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
wordcloud2(df,size = .80,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
df <-  data.frame(Palabra  = c("Temor","Conocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(35,23,32,25,10,18)
)
wordcloud2(df,size = .80,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
wordcloud2(df,size = .70,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
df <-  data.frame(Palabra  = c("Temor","Conocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(40,23,32,25,10,18)
)
wordcloud2(df,size = .70,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
df <-  data.frame(Palabra  = c("Temor","Conocimiento","Repercusiones","Desinterés","Solución Interna","Capacitacion"),
Cantidad  = c(40,23,32,40,10,18)
)
wordcloud2(df,size = .70,minRotation = -pi/6, maxRotation = -pi/6, rotateRatio = .75)
#********************************************************************
# 1.1 INSTALAR PAQUETES DE FUNCIONES
#********************************************************************
# Lista de paquetes de funciones a instalar
.packages = c("lme4","lmerTest", "FSA","car","plotly","ggplot2", "plotly", "xlsx","scales","stringr","readr","dplyr","psych","readxl","ggpubr","PerformanceAnalytics")
#********************************************************************
# 1.2 CARGAR PAQUETES O CREAR FUNCIONES
#********************************************************************
# Carga los paquetes sinÃ³ los tienes cargados
lapply(.packages, require, character.only=TRUE)
#Cargo los Datos
setwd("~/Analiza tus Datos/Etapa 2/Bloque 5 Analiza tus Datos/3. Tablas ANOVA de 1 FACTOR MAS DE 2 GRUPOS")
df <- read_excel("espalda.xlsx")
df_gruposrepetidos <-  data.frame(
Discapacidad = c(df$`ODI Mes0`[df$Grupo == 0], df$`ODI Mes1`[df$Grupo == 0]),
MesMedicion  = c(rep(0,length(df$`ODI Mes0`[df$Grupo == 0])), rep(1,length(df$`ODI Mes1`[df$Grupo == 0]))),
IdPaciente   = c(seq(1,length(df$`ODI Mes0`[df$Grupo == 0])), seq(1,length(df$`ODI Mes0`[df$Grupo == 0])))
)
df_gruposrepetidos$MesMedicion <- factor(df_gruposrepetidos$MesMedicion, label=c("Mes 0","Mes 1"))
##Se usa lmer porque es lineal mixto
anova_medidarep <-  lmer(Discapacidad ~ MesMedicion + (1|grouping), data=df_gruposrepetidos)
##Se usa lmer porque es lineal mixto
anova_medidarep <-  lmer(Discapacidad ~ MesMedicion + (1|IdPaciente), data=df_gruposrepetidos)
#Calculamos la anova del modelo lineal mixto se usa anova
anova(anova_medidarep)
#Se obtienen los residuos y luego se pasan por shapiro wilks y levenetest
residuos <- residuals(object = anova_medidarep)
#Calculamos la anova del modelo lineal mixto se usa anova
a <- anova(anova_medidarep)
#Se obtienen los residuos y luego se pasan por shapiro wilks y levenetest
residuos <- residuals(object = a)
shapiro.test(residuos) #Validando Normalidad
#Se obtienen los residuos y luego se pasan por shapiro wilks y levenetest
residuos <- residuals(object = a)
shapiro.test(residuos) #Validando Normalidad
#Calculamos la anova del modelo lineal mixto se usa anova
anova(anova_medidarep)
#Se obtienen los residuos y luego se pasan por shapiro wilks y levenetest
residuos <- residuals(object = anova_medidarep)
shapiro.test(residuos) #Validando Normalidad
#
### Grafico los residuales para ver como se ve la distribucion
#
dfre <- data.frame(residuos)
name1 <- names(dfre)
##QQPLOT
p3<-ggqqplot(dfre , x =name1,color = "#FF6666",add.params = list(color = "black"))+
xlab("Distribuci?n Te?rica Normal") + ylab("Cuartiles reales") +
theme_minimal() +
ggtitle(paste("QQ-plot de ", name1,sep = "")) +
theme(plot.title = element_text(hjust = 0.5))
p3 <- ggplotly(p3)
p3
hist(dfre$residuos) ##histograma
ggplot(dfre) +geom_boxplot(mapping = aes(dfre$residuos)) # boxplot
plot(y=(seq(-6,195)),x=dfre$residuos,main="plot(residuos) VISUALMENTE NO \n PARECEN NORMALES usando PLOT")
#EN CASO DE QUE NO SALGA NORMAIDAD USO FRIEDMAN.TEST
friedman.test(df_gruposrepetidos[,1],group=df_gruposrepetidos[,2],blocks=df_gruposrepetidos[,3])
